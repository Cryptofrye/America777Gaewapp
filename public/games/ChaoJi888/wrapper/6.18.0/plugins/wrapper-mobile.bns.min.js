(window.webpackJsonp1561725448952=window.webpackJsonp1561725448952||[]).push([[1],{100:function(t,e){t.exports=function(t){return'<div class="bns-bubble"> <div class="bns-bubble__close i-close"></div> '+t.t("bns.bubbleNotification")+"</div>"}},101:function(t,e,i){},102:function(t,e){t.exports=function(t){return'<div class="footer-item bns-panel"> <div class="bns-panel__item bns-panel__redeem i-redeem">'+t.t("bns.redeem")+'</div> <div class="bns-panel__item bns-panel__info i-info">[i]</div></div>'}},103:function(t,e,i){},104:function(t,e){t.exports=function(t){var e='<li class="menu-list-item bns-menu bns-buttons';return t.isRealMode&&(e+=" bns-real-mode"),e+='"> ',t.isBNSMode||(e+=' <div class="bns-menu__amount f-bold bns-menu__amount-value i-amount"></div> '),e+=" "+t.btn(t)+' <div class="bns-menu__footer"> <div class="bns-menu__timer"> '+t.t("bns.offerExpires")+' <span class="bns-timer"></span> </div> <div class="bns-menu__info i-info">[i]</div> </div></li>'}},105:function(t,e,i){},106:function(t,e){t.exports=function(t){var e='<div class="bns-mobile-panel';return t.cssClass&&(e+=" "+t.cssClass),e+='"> <div class="bns-mobile-panel__amount"><span class="bns-mobile-panel__value i-amount"></span></div></div>'}},107:function(t,e,i){},108:function(t,e){t.exports=function(t){return'<div class="bns-panel-button">'+t.t("bns.playRealMoney")+"</div>"}},109:function(t,e,i){},110:function(t,e){t.exports=function(t){return'<div class="bns-mobile-notification"> <div class="bns-mobile-notification__tooltip f-bold bns-mobile-notification__timer bns-timer f-bold"></div> <div class="bns-mobile-button bns-mobile-button-bns i-button"></div></div>'}},111:function(t,e,i){},112:function(t,e){t.exports=function(t){return'<div class="bns-mobile-notification"> <div class="bns-mobile-notification__tooltip f-bold bns-mobile-notification__amount i-amount"></div> <div class="bns-mobile-button bns-mobile-button-real i-button"></div></div>'}},113:function(t,e,i){},114:function(t,e,i){},115:function(t,e,i){},122:function(t,e,i){"use strict";i.r(e);var o=i(0),s=i(4),n=i(9),r=i(10),a=i(2),p=i(1),u=i(13),l=i(6),h=i(14),c=i(30),d=i(3),m=i(25),f=function(t){function e(){var e=t.call(this)||this;e.isActive=!1,e.isRoundEnded=!0,e.isVisible=!0,e.isBNSMode=!1,e._isUserHasLostBonusCoins=!1,e._amount=0,e._autoRedeemBalance=0,e._isSkipAvailableRedeem=!1,e.hasInit=!1,e.isProlong=!1,e.ls_key="offer",e.wrapperModel=Object(p.c)(l.a),e.moneyFormatter=new m.a,e.storageManager=Object(p.c)(c.a),e.dispatcher=Object(p.c)(d.a);var i=e.wrapperModel.token,o=i.playmode;i.currency;return e.isBNSMode="bns"===o,e.isBNSMode&&Object(p.c)(h.a).setJurisdictionLimitsConfig("gb",{numberOfSpinsOnly:!0}),e.dispatcher.on("BC_UI_UPDATE",e.saveUIOptions,e),e}return o.d(e,t),Object.defineProperty(e.prototype,"isUserHasLostBonusCoins",{get:function(){return this._isUserHasLostBonusCoins},enumerable:!0,configurable:!0}),e.prototype.update=function(t){var e=t.expireCountdown,i=t.amount,o=t.expireAt;this._isUserHasLostBonusCoins=this.isBNSMode&&!this.isExpired()&&0===e&&0===i,this.isUserHasLostBonusCoins||this.updateTime(o,e),this.isProlong=this.hasInit&&t.rewardedAmount>this.rewardedAmount,this.rewardedAmount=t.rewardedAmount,this.updateAmount(i,!0),this.exchangeRate=t.exchangeRate,this._redeemMaxAmount=t.redeemMaxAmount,this._redeemMinAmount=t.redeemMinAmount,this.isAmountExceedsMax=this._redeemMaxAmount&&this._redeemMaxAmount<this._amount,this._redeemBalance=void 0!==t.redeemBalance?t.redeemBalance:i,this.redeemCurrency=t.redeemCurrency||this.wrapperModel.getCurrencyCode(),this.promoId=t.promoId,this.hasInit||(this.hasInit=!0)},e.prototype.saveUIOptions=function(t){this.savedUIOptions=o.a({},this.savedUIOptions,t)},e.prototype.updateTime=function(t,e){var i=new Date(t).getTime(),o=i-Date.now()-1e3*e;console.log("TIMER DELTA",o),this.expireDate=i-o,this.expireCountdown=e},e.prototype.updateAmount=function(t,e){void 0===e&&(e=!1),this._amount=t<0?0:t,this.isBNSMode&&e||(this.emit("BC_UPDATE_AMOUNT"),this.isProlong&&this.isActive&&(this.isProlong=!1,this.updateOfferPopup()))},e.prototype.invisible=function(){this.isBNSMode||(this.isVisible=!1,this.emit("BC_VISIBLE",!1))},e.prototype.destroyNotification=function(){this.emit("BC_DESTROY_NOTIFICATION"),this.clear()},e.prototype.activate=function(){if(!this.isActive){this.moneyFormatter.setCurrencySymbol("BNS");var t=this.readStorage(this.ls_key);this.isVisible=!0,t?+t<this.rewardedAmount&&this.updateOfferPopup():(!this.isBNSMode&&this.expireCountdown>1&&this.dispatcher.emit("BC_OFFER_POPUP"),this.saveRewardedAmound()),this.emit("BC_UPDATE_AMOUNT"),this.isActive=!0}},e.prototype.clear=function(){this.isActive=!1,this.isVisible=!0,this.hasInit=!1,this._amount=0,this.storageManager.removeItem(this.bnsKey)},e.prototype.checkRedeemResponse=function(){var t=s.a.getUrlParam("promo_id"),e=this.storageManager.getItem("bns_redeem");if(!t||!e)return!1;var i=JSON.parse(e);return!(i.id!==t||!i.result)&&(this.redeemCurrency=i.result.redeemCurrency,this._autoRedeemBalance=i.result.redeemBalance,this.storageManager.removeItem("bns_redeem"),!0)},e.prototype.format=function(t){return this.moneyFormatter.formatNumber(t,b(t))},e.prototype.isAvailableRedeem=function(){return!this.isBNSMode||(this.isRoundEnded||this._isSkipAvailableRedeem)},e.prototype.isExpired=function(){return this.expireTime<2e3&&this.isAvailableRedeem()},e.prototype.keepRedeemResponse=function(t){var e={id:this.promoId,result:t};this.storageManager.setItem("bns_redeem",JSON.stringify(e))},e.prototype.updateAutoRedeemBalance=function(t){this._autoRedeemBalance=t},e.prototype.updateOfferPopup=function(){this.isVisible||(this.isVisible=!0,this.emit("BC_VISIBLE",!0)),this.dispatcher.emit("BC_UPDATE_OFFER_POPUP"),this.saveRewardedAmound()},Object.defineProperty(e.prototype,"expireTime",{get:function(){var t=this.expireDate-Date.now();return t<0?0:t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullAmount",{get:function(){return this.format(this._amount)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redeemBalance",{get:function(){return this.formatWithCurrency(this._redeemBalance)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redeemMaxAmount",{get:function(){return void 0===this._redeemMaxAmount?"":this.format(this._redeemMaxAmount)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redeemMinAmount",{get:function(){return this.format(this._redeemMinAmount)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEligibleRedeem",{get:function(){return this._amount>=this._redeemMinAmount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoRedeemBalance",{get:function(){return this.formatWithCurrency(this._autoRedeemBalance)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedExchangeRate",{get:function(){return this.formatWithCurrency(1e3*this.exchangeRate)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSkipAvailableRedeem",{get:function(){return this._isSkipAvailableRedeem},set:function(t){this._isSkipAvailableRedeem=t},enumerable:!0,configurable:!0}),e.prototype.formatWithCurrency=function(t){var e=new m.a;return e.setCurrencySymbol(this.redeemCurrency),e.formatNumber(t,b(t))},e.prototype.saveRewardedAmound=function(){this.writeStorage(this.ls_key,this.rewardedAmount)},e.prototype.getStorageData=function(){var t=this.storageManager.getItem(this.bnsKey);return t?JSON.parse(t):{}},e.prototype.writeStorage=function(t,e){void 0===e&&(e=null);var i=this.getStorageData();e?i[t]=e:delete i[t],this.storageManager.setItem(this.bnsKey,JSON.stringify(i))},e.prototype.readStorage=function(t){return this.getStorageData()[t]},Object.defineProperty(e.prototype,"bnsKey",{get:function(){return"bns_"+this.promoId},enumerable:!0,configurable:!0}),e=o.c([p.a],e)}(u.EventEmitter);function b(t){return{decimalPartAppendType:0,shortMode:t>=(Math.floor(t)===t?1e6:1e3)}}var y=i(7),v=i(12),_=function(){function t(){this.locale=Object(p.c)(r.a),this.model=Object(p.c)(f);var t=Object(p.c)(l.a).path,e=this.locale.getLocale();this.localePath=t+"i18n/"+e+"/"}return t.prototype.getInfoContent=function(){var t=this;if(this.infoText)return Promise.resolve(this.infoText);var e=Object(p.c)(v.a),i=e.showLoading();return y.a.loadText(this.localePath+"bns.html").then(function(o){return e.hide(i),t.infoText=o,o})},t.prototype.loadResources=function(){var t=[this.locale.loadPlugin("bns"),this.loadFonts(),this.loadImages()];return Promise.all(t)},t.prototype.loadImages=function(){var t="zh-cn"===this.locale.getLocale(),e=[t?"bns-logo.zh-cn":"bns-logo","bns-shine","bns-button"],i=["bns-info",t?"bns-logo-small.zh-cn":"bns-logo-small"],o=[t?"bns-logo-bnsmode.zh-cn":"bns-logo-bnsmode"];return e.push(t?"m_menu_logo.zh-cn":"m_menu_logo","m-clock","m_menu_info","m_menu_button_arrow","m_menu_button_big"),o.push("m_bns-mode","m_bns-mode-short","m_button_clock"),y.a.loadImages(Object(n.i)(e.concat(this.model.isBNSMode?o:i).map(function(t){return t+".png"})))},t.prototype.loadFonts=function(){var t=document.fonts;if(!t)return Promise.resolve();var e=["1pt 'Noto Sans'","bold 1pt 'Noto Sans'","vi"===this.locale.getLocale()?"1pt vi-NotoSansCJKsc-Bold":"1pt Impact"].map(function(e){return t.load(e)});return Promise.all(e).catch(function(){return Promise.resolve()})},t=o.c([p.a],t)}(),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.model=Object(p.c)(f),e}return o.d(e,t),e.prototype.prepareOptions=function(){return this.options.model=this.model,this.options.templateButton=i(84),t.prototype.prepareOptions.call(this)},e.prototype.getTemplate=function(){return i(93)},e}(i(15).a);i(94);var B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.show=function(){t.prototype.show.call(this),this.timerNode=this.overlay.querySelector(".bns-timer"),this.dispatcher.on("BC_UPDATE_TIMER",this.updateTimer,this)},e.prototype.hide=function(){this.dispatcher.off("BC_UPDATE_TIMER",this.updateTimer,this),this.timerNode=null,t.prototype.hide.call(this)},e.prototype.updateTimer=function(t){Object(a.p)(this.timerNode,t.full)},e}(g),M=function(t){function e(){var e,i=null!==t&&t.apply(this,arguments)||this;return i.events=((e={".i-info":i.info})[i.device.event.down+" .i-info"]=i.soundClick,e),i}return o.d(e,t),e.prototype.prepareOptions=function(){return this.options.buttons=this.model.isBNSMode?{title:"ok",action:this.playNow,sound:!0}:[{title:"bns.playBonusNow",action:this.playNow,sound:!0},{title:"bns.playLater",sound:!0}],t.prototype.prepareOptions.call(this)},e.prototype.playNow=function(){this.model.isBNSMode||this.dispatcher.emit("BC_PLAY_NOW")},e.prototype.info=function(){var t=this;this.close(),this.dispatcher.emit("BC_INFO_POPUP",function(){return t.dispatcher.emit(t.options.caller)})},e.prototype.getTemplate=function(){return this.options.timer=i(85),i(95)},e.prototype.addListeners=function(){t.prototype.addListeners.call(this),this.model.on("BC_UPDATE_AMOUNT",this.updateAmount,this)},e.prototype.removeListeners=function(){t.prototype.removeListeners.call(this),this.model.off("BC_UPDATE_AMOUNT",this.updateAmount,this)},e.prototype.updateAmount=function(){this.overlay.querySelector(".message").innerHTML=this.processField("",this.options.message)},e}(B),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.getTemplate=function(){return this.options.timer=i(85),i(96)},e}(B),T=i(36),O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.disabled=!1,e}return o.d(e,t),e.prototype.addListeners=function(){t.prototype.addListeners.call(this),this.eventDispatcher.on("POPUP_STATE_UPDATE",this.changeState,this)},e.prototype.changeState=function(t){this.disabled=t,Object(a.m)(this.el,t)},e}(T.a),A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.render=function(){var e=t.prototype.render.call(this);return this.timerNode=this.el.querySelector(".bns-timer"),e},e.prototype.addListeners=function(){t.prototype.addListeners.call(this),this.eventDispatcher.on("BC_UPDATE_TIMER",this.updateTimer,this)},e.prototype.removeListeners=function(){t.prototype.removeListeners.call(this),this.eventDispatcher.off("BC_UPDATE_TIMER",this.updateTimer,this)},e.prototype.destroy=function(){this.timerNode=null,t.prototype.destroy.call(this)},e.prototype.updateTimer=function(t){Object(a.p)(this.timerNode,t.full),this.el.classList.toggle("hot",t.hot)},e}(T.a),C=(i(97),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.model=Object(p.c)(f),e.disabled=!1,e.events=e.model.isBNSMode?{}:{".i-amount-area":e.click},e}return o.d(e,t),e.prototype.render=function(){return t.prototype.render.call(this),this.toolTipElement=this.el.querySelector(".tooltip-timer"),this.amountElement=this.el.querySelector(".i-amount"),this.updateAmount(),e.setParentNodeState(!0),this.el},e.prototype.destroy=function(){e.setParentNodeState(!1),this.toolTipElement=null,this.amountElement=null,t.prototype.destroy.call(this)},e.prototype.getTemplate=function(){return i(98)},e.prototype.addListeners=function(){t.prototype.addListeners.call(this),this.model.on("BC_UPDATE_AMOUNT",this.updateAmount,this),this.model.isBNSMode||(this.model.on("BC_VISIBLE",this.setVisible,this),this.eventDispatcher.on("POPUP_STATE_UPDATE",this.changeState,this))},e.prototype.removeListeners=function(){t.prototype.removeListeners.call(this),this.model.off("BC_UPDATE_AMOUNT",this.updateAmount,this),this.model.isBNSMode||(this.model.off("BC_VISIBLE",this.setVisible,this),this.eventDispatcher.off("POPUP_STATE_UPDATE",this.changeState,this))},e.prototype.updateTimer=function(e){t.prototype.updateTimer.call(this,e),Object(a.p)(this.timerNode,e.short),Object(a.p)(this.toolTipElement,e.full)},e.setParentNodeState=function(t){document.querySelector(".footer-panel").classList.toggle("bns-notification",t)},e.prototype.click=function(){this.disabled||this.eventDispatcher.emit("BC_STATUS_POPUP")},e.prototype.updateAmount=function(){Object(a.p)(this.amountElement,this.model.fullAmount)},e.prototype.changeState=function(t){this.disabled=t,Object(a.m)(this.el,t)},e.prototype.setVisible=function(t){Object(a.n)(this.el,!t),e.setParentNodeState(t)},e}(A)),P=(i(99),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events={".i-close":e.close,"mousedown .i-close":e.playSound},e}return o.d(e,t),e.prototype.getTemplate=function(){return i(100)},e.prototype.render=function(){return t.prototype.render.call(this),this.closeTimer=setTimeout(this.close.bind(this),5e3),this.playSound(),this.el},e.prototype.close=function(){clearTimeout(this.closeTimer),this.el.classList.add("bns-bubble--hide"),setTimeout(this.destroy.bind(this),2e3)},e.prototype.playSound=function(){this.eventDispatcher.emit("BUTTON_CLICK")},e}(T.a)),S=(i(101),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events={".i-redeem":e.redeem,".i-info":e.info},e}return o.d(e,t),e.prototype.render=function(){var e=t.prototype.render.call(this),i=new C({cssClass:"bns-panel__item bns-panel__balance",amount:""});return e.insertBefore(i.render(),e.firstChild),setTimeout(this.tooltip.bind(this),1500),e},e.prototype.tooltip=function(){var t=new P;this.el.querySelector(".bns-notification__value").appendChild(t.render())},e.prototype.redeem=function(){this.disabled||this.eventDispatcher.emit("BC_REDEEM")},e.prototype.info=function(){this.disabled||this.eventDispatcher.emit("BC_INFO_POPUP")},e.prototype.getTemplate=function(){return i(102)},e}(O)),N=(i(103),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.model=Object(p.c)(f),e.events=e.model.isBNSMode?{".i-info":e.info,".i-redeem":e.redeem,".i-go-back":e.realMode}:{".i-info":e.info,".i-play-now":e.playNow},e}return o.d(e,t),e.prototype.addListeners=function(){t.prototype.addListeners.call(this),this.model.isBNSMode||this.model.on("BC_DESTROY_NOTIFICATION",this.destroy,this).on("BC_UPDATE_AMOUNT",this.updateAmount,this)},e.prototype.removeListeners=function(){t.prototype.removeListeners.call(this),this.model.isBNSMode||this.model.off("BC_DESTROY_NOTIFICATION",this.destroy,this).off("BC_UPDATE_AMOUNT",this.updateAmount,this)},e.prototype.render=function(){var e=t.prototype.render.call(this);return this.model.isBNSMode||(this.amountElement=e.querySelector(".i-amount"),this.updateAmount()),this.eventDispatcher.emit("MENU_SET_OPTIONS",{scrollHeader:!0}),e},e.prototype.destroy=function(){this.model.isBNSMode||(this.amountElement=null),this.eventDispatcher.emit("MENU_SET_OPTIONS",{scrollHeader:!1}),t.prototype.destroy.call(this)},e.prototype.getTemplate=function(){var t=this.model.isBNSMode,e=t?[{title:"bns.playRealMoney",cssClass:"i-go-back",sound:!0},{title:"bns.redeem",cssClass:"i-redeem m-redeem",sound:!0}]:[{title:"bns.playBonusNow",cssClass:"i-play-now",sound:!0}];return this.options={buttons:e,isBNSMode:t,templateButton:i(84),btn:i(41)},i(104)},e.prototype.updateAmount=function(){Object(a.p)(this.amountElement,this.model.fullAmount)},e.prototype.action=function(t){this.eventDispatcher.emit("MENU_STATE",{open:!1}),this.eventDispatcher.emit(t)},e.prototype.playNow=function(){this.action("BC_PLAY_NOW")},e.prototype.info=function(){this.action("BC_INFO_POPUP")},e.prototype.realMode=function(){this.action("BC_SWITCH_MODE")},e.prototype.redeem=function(){this.action("BC_REDEEM")},e}(A)),U=i(23),I=i(17),R=i(29),w=function(){function t(){this.server=Object(p.c)(U.a),this.model=Object(p.c)(f),this.wrapperModel=Object(p.c)(l.a),this.balanceModel=Object(p.c)(I.a),this.popupManager=Object(p.c)(v.a),this.dispatcher=Object(p.c)(d.a),this.addListeners(),this.remapErrorMessages(),this.model.isBNSMode&&this.server.setSettings({jpUpdateBalance:!1})}return t.prototype.switchMode=function(t,e){return o.b(this,void 0,void 0,function(){var i,s,n,r,a,p;return o.e(this,function(o){switch(o.label){case 0:i=this.wrapperModel.startGameToken,s=this.popupManager.showLoading(),n=this.server.getGameCode(),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.server.genericRequest({gameId:n,playmode:t,request:"choose-game",startGameToken:i},{hasRequestId:!1})];case 2:return r=o.sent(),a=r.url,p=e?"&promo_id="+e:"",location.href=""+a+p+"&ac="+Date.now(),[3,4];case 3:return o.sent(),this.popupManager.hide(s),[3,4];case 4:return[2]}})})},t.prototype.redeem=function(t){return o.b(this,void 0,void 0,function(){var e,i,s,n,r,a,p,u,l,h;return o.e(this,function(o){switch(o.label){case 0:e=this.model,i=e.promoId,s=e.isBNSMode,n={request:"redeem-bns",promoId:i,manual:t},r=this.popupManager.showLoading(),a={hasRequestId:!1},(p=!t||this.model.isEligibleRedeem)&&(a.ignoreErrorCodes=[519]),o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,this.server.genericRequest(n,a)];case 2:return u=o.sent(),s||this.updateVisualBalance(),[2,u.result];case 3:return l=o.sent(),console.log(l),h=void 0,p&&l&&519===l.code&&(h={goToRealMode:!0}),[2,Promise.reject(h)];case 4:return this.popupManager.hide(r),[7];case 5:return[2]}})})},t.prototype.updateBalance=function(){return o.b(this,void 0,void 0,function(){var t;return o.e(this,function(e){switch(e.label){case 0:return[4,this.server.balanceRequest()];case 1:return t=e.sent().balance,this.model.isBNSMode||this.updateVisualBalance(),[2,t]}})})},t.prototype.isExpired=function(){return o.b(this,void 0,void 0,function(){var t;return o.e(this,function(e){switch(e.label){case 0:return[4,this.updateBalance()];case 1:return[2,!(t=e.sent().bonusCoins)||t.expireCountdown<2]}})})},t.prototype.remapErrorMessages=function(){var t,e,i=this,o=Object(p.c)(R.a);if(o.add(((t={})[519]={message:"bns.error.notEnoughBnsToRedeem",buttons:{title:"ok"}},t[691]={message:"bns.error.insufficientBonusCoinsBalance",buttons:{title:"refresh",actionEvent:"RELOAD"}},t)),this.model.isBNSMode){var s={title:"ok",action:function(){return i.switchMode("real")}};o.add(((e={})[681]={message:"bns.error.promotionHasExpired",buttons:s},e[521]={message:"bns.error.roundNotFinished",buttons:{title:"ok"}},e[690]={message:"bns.error.bonusCoinsNotAvailable",buttons:s},e))}},t.prototype.addListeners=function(){this.dispatcher.on("SERVER_RESPONSE",this.onServerResponse,this)},t.prototype.updateVisualBalance=function(){this.balanceModel.forceUpdateVisualBalance()},t.prototype.onServerResponse=function(t){void 0!==t.roundEnded&&(this.model.isRoundEnded=t.roundEnded)},t}(),D=i(8),x=(i(105),i(19)),L=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.model=Object(p.c)(f),e.gameType=Object(p.c)(x.a).features.mark,e.isUsingInnerScaleMethod=!0,e}return o.d(e,t),e.prototype.addListeners=function(){t.prototype.addListeners.call(this),this.model.on("BC_UPDATE_AMOUNT",this.updateAmount,this),this.eventDispatcher.on("RESIZE",this.onResize,this).on("BC_UI_UPDATE",this.updateUI,this)},e.prototype.removeListeners=function(){t.prototype.removeListeners.call(this),this.model.off("BC_UPDATE_AMOUNT",this.updateAmount,this),this.eventDispatcher.off("RESIZE",this.onResize,this).off("BC_UI_UPDATE",this.updateUI,this)},e.prototype.destroy=function(){this.amountElement=null,t.prototype.destroy.call(this)},e.prototype.render=function(){return t.prototype.render.call(this),this.multiline(4===this.gameType),this.amountElement=this.el.querySelector(".i-amount"),this.updateAmount(),this.onResize(),this.el},e.prototype.getTemplate=function(){return i(106)},e.prototype.updateAmount=function(){Object(a.p)(this.amountElement,this.model.fullAmount),this.scaleAmount()},e.prototype.scaleAmount=function(){var t=getComputedStyle(this.amountElement.parentElement),e=parseFloat(t.width);Object(a.f)(this.amountElement,1,e,"em",.01),this.amountElement.style.lineHeight=t.height},e.prototype.onResize=function(){var t=4===this.gameType,e=this.device.getScreenResolution(),i=e.isLandscape?t?1780:1350:760,o=Math.min(e.width/i,.8),s=t?Math.min(20.267*o,14.7):20.267*o,n=this.el.style;n.fontSize=s+"px",n.top=e.height+"px",this.scaleAmount()},e.prototype.onUpdateBalanceBounds=function(t){this.isUsingInnerScaleMethod&&(this.isUsingInnerScaleMethod=!1,this.eventDispatcher.off("RESIZE",this.onResize,this)),Object(a.e)(this.el,t,!0),this.scaleAmount()},e.prototype.show=function(){t.prototype.show.call(this),this.scaleAmount()},e.prototype.multiline=function(t){Object(a.l)(this.el,"bns-mobile-panel-short",t)},e.prototype.updateUI=function(t){var e=t.bonusCoinsUIVisibility,i=t.balancePanelVisibility,o=t.balancePanelBounds,s=t.multilineBalancePanel;t.disabledBalancePanel?this.destroy():(void 0!==e&&(this.visible=e),void 0!==i&&(this.visible=i),void 0!==o&&this.onUpdateBalanceBounds(o),void 0!==s&&(this.multiline(s),this.scaleAmount()))},e}(T.a),k=(i(107),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events={this:e.back},e}return o.d(e,t),e.prototype.back=function(){this.disabled||this.eventDispatcher.emit("BC_SWITCH_MODE")},e.prototype.getTemplate=function(){return i(108)},e}(O)),j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events={".i-button":e.openMenu},e.hideOnMenuOpen=!0,e.bnsButtonModel={},e}return o.d(e,t),e.prototype.render=function(){return this.eventDispatcher.emit("SHOW_GAME_MENUBUTTON",!1),this.eventDispatcher.emit("MENU_SET_OPTIONS",{buttonStyle:{opacity:"0"}}),t.prototype.render.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.eventDispatcher.emit("SHOW_GAME_MENUBUTTON",!0),this.eventDispatcher.emit("MENU_SET_OPTIONS",{buttonStyle:{opacity:"1"}})},e.prototype.addListeners=function(){t.prototype.addListeners.call(this),this.eventDispatcher.on("BC_UI_UPDATE",this.updateUI,this).on("MENU_STATE",this.onMenuState,this).on("MENU_VISIBILITY",this.onMenuVisible,this)},e.prototype.removeListeners=function(){t.prototype.removeListeners.call(this),this.eventDispatcher.off("BC_UI_UPDATE",this.updateUI,this).off("MENU_STATE",this.onMenuState,this).off("MENU_VISIBILITY",this.onMenuVisible,this)},e.prototype.onMenuVisible=function(t){t&&!this.hideOnMenuOpen||this.isButtonHiddenByBCUIUpdate||this.setVisibility(!t)},e.prototype.openMenu=function(){this.eventDispatcher.emit("MENU_STATE",{open:!0})},e.prototype.onMenuState=function(t){var e=t.enabled;void 0!==e&&Object(a.m)(this.el,!e)},e.prototype.onUpdateMenuBounds=function(){var t=this.el,e=this.bnsButtonModel.bounds;e&&Object(a.e)(t,e)},e.prototype.updateUI=function(t){var e=t.bonusCoinsUIVisibility,i=t.disabledBNSMenu,o=t.menuButtonBounds;this.configureButton(t),void 0!==e&&(this.isButtonHiddenByBCUIUpdate=!e,this.setVisibility(e)),void 0!==o&&this.setMenuBounds(o),i&&this.destroy()},e.prototype.configureButton=function(t){var e=t.menuButtonLayout,i=t.menuButtonPosition,o=t.menuButtonSize,s=t.menuButtonSkin,n=t.menuButtonVisibility,r=t.hideButtonOnMenuOpen;null!=n&&(this.isButtonHiddenByBCUIUpdate=!n,this.setVisibility(n)),i&&function(t,e){var i=[],o=e.bottom,s=e.left,n=e.right,r=e.top;(r||o)&&(i.push("top: "+(r||"auto")),i.push("bottom: "+(o||"auto")));(s||n)&&(i.push("left: "+(s||"auto")),i.push("right: "+(n||"auto")));t.setAttribute("style",i.join("; "))}(this.el,i),void 0!==e&&function(t,e,i){var o=new RegExp(e+"([\\w-]*)").exec(t.getAttribute("class"));o&&t.classList.remove(o[0]);i&&t.classList.add(e+i)}(this.el,"bns-button-layout-",e);var a=this.el.querySelector(".bns-mobile-button");if(a){var p="";s&&(p+="background-image: url("+s+"); "),o&&(p+="height: "+o+"; width: "+o+";"),a.setAttribute("style",p),void 0!==r&&(this.hideOnMenuOpen=r)}},e.prototype.setVisibility=function(t){this.visible=t,t&&this.onUpdateMenuBounds()},e.prototype.setMenuBounds=function(t){this.bnsButtonModel.bounds=t,this.visible&&this.onUpdateMenuBounds()},e}(T.a);i(86),i(109);var V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.d(e,t),e.prototype.render=function(){var e=t.prototype.render.call(this);return this.timerNode=this.el.querySelector(".bns-timer"),e},e.prototype.getTemplate=function(){return i(110)},e.prototype.addListeners=function(){t.prototype.addListeners.call(this),this.eventDispatcher.on("BC_UPDATE_TIMER",this.updateTimer,this)},e.prototype.removeListeners=function(){t.prototype.removeListeners.call(this),this.eventDispatcher.off("BC_UPDATE_TIMER",this.updateTimer,this)},e.prototype.destroy=function(){this.timerNode=null,t.prototype.destroy.call(this)},e.prototype.updateTimer=function(t){Object(a.p)(this.timerNode,t.short)},e}(j),F=(i(111),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.model=Object(p.c)(f),e}return o.d(e,t),e.prototype.render=function(){var e=t.prototype.render.call(this);return this.amountElement=e.querySelector(".i-amount"),this.updateAmount(),e},e.prototype.destroy=function(){this.amountElement?(this.amountElement=null,t.prototype.destroy.call(this),this.eventDispatcher.emit("SHOW_GAME_MENUBUTTON",!0)):this.eventDispatcher.emit("BC_HIDE_CUSTOM_REAL_BUTTON")},e.prototype.getTemplate=function(){return i(112)},e.prototype.addListeners=function(){t.prototype.addListeners.call(this),this.model.on("BC_DESTROY_NOTIFICATION",this.destroy,this).on("BC_UPDATE_AMOUNT",this.updateAmount,this).on("BC_VISIBLE",this.setVisibility,this)},e.prototype.removeListeners=function(){t.prototype.removeListeners.call(this),this.model.off("BC_DESTROY_NOTIFICATION",this.destroy,this).off("BC_UPDATE_AMOUNT",this.updateAmount,this).off("BC_VISIBLE",this.setVisibility,this)},e.prototype.updateAmount=function(){Object(a.p)(this.amountElement,this.model.fullAmount),Object(a.f)(this.amountElement,13,86)},e.prototype.setVisibility=function(e){t.prototype.setVisibility.call(this,e),this.eventDispatcher.emit("SHOW_GAME_MENUBUTTON",!e)},e}(j));i(42),i(113),i(114);i.d(e,"BonusCoins",function(){return H}),i(115);var H=function(){function t(){this.hasBonusCoins=!1,this.isInit=!1,this.isMenuShow=!1,this.highlightExpirationTimer=+s.a.getUrlParam("bns_expiration_timer")||5,this.locale=Object(p.c)(r.a),this.model=Object(p.c)(f),this.server=new w,this.popupManager=Object(p.c)(v.a),this.loader=Object(p.c)(_),this.dispatcher=Object(p.c)(d.a),this.initialize()}return t.prototype.ready=function(){return this.loader.loadResources()},t.prototype.initialize=function(){this.checkIsOfferOnGamePlay(),this.highlightExpirationTimer=36e5*Math.abs(this.highlightExpirationTimer)+6e4,this.addListeners()},t.prototype.addListeners=function(){this.dispatcher.on("BC_EXPIRED",this.expired,this).on("BC_PLAY_NOW",this.playNow,this).on("BC_SWITCH_MODE",this.showRealModePopup,this).on("MENU_STATE",this.onMenuChange,this).on("BC_REDEEM",this.onRedeemAction,this).on("BC_INFO_POPUP",this.showInfoPopup,this).on("BC_OFFER_POPUP",this.showOfferPopup,this).on("BC_UPDATE_OFFER_POPUP",this.showUpdateOfferPopup,this).on("BC_STATUS_POPUP",this.showStatusPopup,this).on("FORCE_BC_UI_UPDATE",this.updateTimer,this).on("balanceUpdate",this.updateBalance,this).on("viewBalanceUpdate",this.updateBnsBalance,this).once("BC_SKIP_AVAILABLE_REDEEM_CHECK",this.onSkipAvailableRedeemCheck,this)},t.prototype.updateBalance=function(t){var e=t.bonusCoins;this.hasBonusCoins=!!e,this.hasBonusCoins?(console.log("BNS: Update model"),this.model.update(e),this.isInit||this.init(),this.isOfferOnGameplay&&this.isMenuShow&&!this.model.isActive&&(this.isOfferOnGameplay=!1,this.activate()),this.model.isUserHasLostBonusCoins&&this.model.clear()):this.isInit&&this.model.isVisible&&(this.model.destroyNotification(),this.checkIsOfferOnGamePlay())},t.prototype.init=function(){this.model.isBNSMode,this.isInit=!0},t.prototype.onMenuChange=function(t){return o.b(this,void 0,void 0,function(){return o.e(this,function(e){switch(e.label){case 0:return t.visible?(this.dispatcher.off("MENU_STATE",this.onMenuChange,this),this.model.isBNSMode||!this.model.checkRedeemResponse()?[3,2]:[4,this.showAutoRedeemPopup()]):[2];case 1:e.sent(),e.label=2;case 2:return this.isMenuShow=!0,this.hasBonusCoins&&this.activate(),[2]}})})},t.prototype.onSkipAvailableRedeemCheck=function(){this.model.isSkipAvailableRedeem=!0},t.prototype.activate=function(){this.model.isActive||(this.model.isBNSMode?this.updateBonusCoinsUI():this.showNotification(),this.model.activate(),this.startTimer())},t.prototype.showPopup=function(t,e,i){this.currentPopupId=this.popupManager.show(t,e,i)},t.prototype.showUpdateOfferPopup=function(){this.showPopup(6,{cssClass:"offer-popup",clock:this.clock().full,caller:"BC_UPDATE_OFFER_POPUP",message:"bns.offerUpdateMessage"},M)},t.prototype.showOfferPopup=function(){this.showPopup(6,{cssClass:"offer-popup",clock:this.clock().full,caller:"BC_OFFER_POPUP",title:"bns.congratulations",message:"bns.offerMessage"},M)},t.prototype.showStatusPopup=function(){this.showPopup(6,{cssClass:"bns-popup--light",clock:this.clock().full,caller:"BC_STATUS_POPUP",message:"bns.offerMessage"},M)},t.prototype.showInfoPopup=function(t){return o.b(this,void 0,void 0,function(){var e;return o.e(this,function(o){switch(o.label){case 0:return[4,this.loader.getInfoContent()];case 1:return e=o.sent(),this.showPopup(4,{buttons:[],cbClose:t,templateButton:i(84),content:e,className:"bns-popup bns-info-popup",hideOverlay:!1,params:{minBns:this.model.redeemMinAmount,maxBns:this.model.redeemMaxAmount,rate:this.model.formattedExchangeRate}}),[2]}})})},t.prototype.updateTimer=function(){this.dispatcher.emit("BC_UPDATE_TIMER",this.clock())},t.prototype.startTimer=function(){this.updateTimer(),this.model.isExpired()?this.checkExpiration():setTimeout(this.startTimer.bind(this),this.model.expireCountdown?6e3:500)},t.prototype.checkExpiration=function(){return o.b(this,void 0,void 0,function(){var t;return o.e(this,function(e){switch(e.label){case 0:return console.log("BNS: Check Balance Before Expire"),(t=this.model.isUserHasLostBonusCoins)?[3,2]:[4,this.server.isExpired()];case 1:t=e.sent(),e.label=2;case 2:return t?this.dispatcher.emit("BC_EXPIRED"):this.startTimer(),[2]}})})},t.prototype.clock=function(){var t=this.model.expireTime,e=new Date(t),i=Math.floor(t/864e5),o=e.getUTCHours(),s=e.getUTCMinutes(),r=Object(n.b)(o,s);return{short:i>0?i+" d "+r:r,full:""+(i>0?i+" "+this.locale.plural("bns.day",i)+" ":"")+(r+" "+this.locale.plural("bns.hour",o)),hot:t<=this.highlightExpirationTimer}},t.prototype.playNow=function(){this.server.switchMode("bns")},t.prototype.showRealModePopup=function(){this.showPopup(6,{cssClass:"bns-popup--info",message:"bns.realModeQuestion",buttons:[this.popupButton("yes",this.goToRealMode),this.popupButton("no")]},g)},t.prototype.showNotification=function(){this.model.expireTime&&(this.notification=new F,this.dispatcher.emit("ADD_MENU_WIDGET",{widget:this.notification}),this.dispatcher.emit("BC_CREATE_BUTTON_BNS_MOBILE"),this.updateMobileMenu())},t.prototype.expired=function(){this.model.isBNSMode?(this.onBCReadyToRedeem(),this.showExpirationPopup()):this.model.isEligibleRedeem?this.redeem(!1):this.destroy()},t.prototype.showExpirationPopup=function(){var t=this,e=this.model,i=e.isAmountExceedsMax,o=e.isEligibleRedeem,s=o&&i,n={cssClass:"bns-popup--info",message:o?"bns.expirationEligible":"bns.expirationNotEligible",extraMessage:s&&"bns.redeemMaxMessage",showExtraMessage:s,buttons:this.popupButton("ok",function(){o?(t.popupManager.hideAll(),t.redeem(!1)):t.goToRealMode()})};this.model.isBNSMode&&this.popupManager.hideAll(),this.showPopup(6,n,g)},t.prototype.goToRealMode=function(t){this.server.switchMode("real",t)},t.prototype.hideCurrentPopup=function(){this.popupManager.hide(this.currentPopupId),this.currentPopupId=null},t.prototype.destroy=function(){this.currentPopupId&&this.hideCurrentPopup(),this.notification&&(this.notification.destroy(),this.notification=null),this.menuMobileItem&&(this.menuMobileItem.destroy(),this.menuMobileItem=null),this.model.clear(),this.isInit=!1,this.checkIsOfferOnGamePlay()},t.prototype.updateMobileMenu=function(){var t=this;this.menuMobileItem=new N,this.dispatcher.emit("ADD_MENU_WIDGET",{insert:!0,widget:this.menuMobileItem,selector:".menu-list-item:first-child"}),setTimeout(function(){t.dispatcher.emit("SHOW_GAME_MENUBUTTON",!1),t.dispatcher.emit("BC_UI_UPDATE",t.model.savedUIOptions)},0)},t.prototype.updateBonusCoinsUI=function(){this.mobileBNSMode()},t.prototype.onBCReadyToRedeem=function(){this.model.isSkipAvailableRedeem&&this.dispatcher.emit("BC_READY_TO_REDEEM")},t.prototype.onRedeemAction=function(){this.model.isAvailableRedeem()?this.showRedeemPopup():this.dispatcher.emit("ERROR_POPUP",{message:"bns.error.roundNotFinished",buttons:{title:"ok"}})},t.prototype.showRedeemPopup=function(){var t=this,e=this.clock().full,i=this.model.isAmountExceedsMax,o=this.model.isEligibleRedeem?{clock:e,cssClass:"bns-popup--light",message:"bns.redeemEligible",extraMessage:"bns.redeemMaxMessage",showExtraMessage:i,buttons:[this.popupButton("yes",function(){t.onBCReadyToRedeem(),t.redeem(!0)}),this.popupButton("no")]}:{clock:e,message:"bns.redeemNotEligible",buttons:this.popupButton("ok")};this.showPopup(6,o,E)},t.prototype.desktopBNSMode=function(){this.dispatcher.emit("ADD_MENU_WIDGET",{widget:new S,selector:".footer-panel-widget"}),this.dispatcher.emit("ADD_MENU_WIDGET",{widget:new k,selector:".footer-panel-col:last-child",insert:!0})},t.prototype.mobileBNSMode=function(){this.notification=new V,this.dispatcher.emit("ADD_MENU_WIDGET",{widget:this.notification}),this.updateMobileMenu(),Object(a.n)(".menu-list-item-cashier"),this.dispatcher.emit("BC_CREATE_BUTTON_BNS_MOBILE"),this.balanceWidget=new L,Object(p.c)(D.a).gameWrapper.appendChild(this.balanceWidget.render()),this.dispatcher.emit("BC_CREATE_PANEL_BNS_MOBILE")},t.prototype.autoRedemptionPopup=function(){var t=this;this.showPopup(6,{cssClass:"bns-popup--auto-redeem",title:"bns.congratulations",message:"bns.autoRedemptionMessage",buttons:this.popupButton("ok",function(){t.hasBonusCoins&&!t.model.isBNSMode||t.destroy()})},g)},t.prototype.redeem=function(t){return o.b(this,void 0,void 0,function(){var e,i,s,n,r;return o.e(this,function(o){switch(o.label){case 0:this.hideCurrentPopup(),e=this.model,i=e.isBNSMode,s=e.promoId,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.server.redeem(t)];case 2:return n=o.sent(),i?(this.popupManager.hideAll(),e.keepRedeemResponse(n),e.clear(),this.goToRealMode(s)):(e.updateAutoRedeemBalance(n.redeemBalance),this.autoRedemptionPopup()),[3,4];case 3:return r=o.sent(),i?r&&r.goToRealMode&&(this.popupManager.hideAll(),e.clear(),this.goToRealMode(s)):this.destroy(),[3,4];case 4:return[2]}})})},t.prototype.showAutoRedeemPopup=function(){var t=this;return this.server.updateBalance().then(function(){return t.autoRedemptionPopup()})},t.prototype.popupButton=function(t,e){var i={title:t,sound:!0};return e&&(i.action=e.bind(this)),i},t.prototype.updateBnsBalance=function(t,e){this.model.isBNSMode&&this.model.updateAmount(t)},t.prototype.checkIsOfferOnGamePlay=function(){this.isOfferOnGameplay="0"!==s.a.getUrlParam("bns_offer_popup_on_gameplay")},t=o.c([p.a],t)}()},84:function(t,e){t.exports=function(t){var e="";return t.title.indexOf("\n")>-1&&(t.title=t.title.replace("\n","<br>"),t.cssClass+=" two-lines"),e+='<div class="generic-button bns-button '+t.cssClass+'"> <span class="bns-button_text">'+t.title+"</span></div>"}},85:function(t,e){t.exports=function(t){return'<div class="popup-footer__timer"> '+t.t("bns.offerExpires")+' <span class="bns-timer">'+t.clock+"</span></div>"}},86:function(t,e,i){},93:function(t,e){t.exports=function(t){var e='<div class="popup-overlay"> <div class="wrapper-popup bns bns-popup f-bold';return t.cssClass&&(e+=" "+t.cssClass),e+='"> ',t.title&&(e+=' <div class="title">'+t.title+"</div> "),e+=" ",t.message&&(e+=' <h2 class="message">'+t.message+"</h2> "),e+=" ",t.showExtraMessage&&(e+=' <div class="message message-small">'+t.extraMessage+"</div> "),e+=" "+t.btn(t)+" </div></div>"}},94:function(t,e,i){},95:function(t,e){t.exports=function(t){var e='<div class="popup-overlay"> <div class="wrapper-popup bns-popup f-bold';return t.cssClass&&(e+=" "+t.cssClass),t.model.isBNSMode||(e+=" m-large-button"),e+='"> ',t.title&&(e+=' <div class="title">'+t.title+"</div> "),e+=' <div class="message">'+t.message+"</div> "+t.btn(t)+' <div class="popup-footer l-inline"> '+t.timer(t)+' <div class="popup-footer__info i-info">[i]</div> </div> </div></div>'}},96:function(t,e){t.exports=function(t){var e='<div class="popup-overlay"> <div class="wrapper-popup bns bns-popup f-bold';return t.cssClass&&(e+=" "+t.cssClass),e+='"> <div class="message">'+t.message+"</div> ",t.showExtraMessage&&(e+=' <div class="message message-small">'+t.extraMessage+"</div> "),e+=" "+t.btn(t)+' <div class="popup-footer l-single">'+t.timer(t)+"</div> </div></div>"}},97:function(t,e,i){},98:function(t,e){t.exports=function(t){return'<div class="bns-notification '+t.cssClass+'"> <div class="bns-notification__value i-amount-area"><span class="i-amount bns-notification__amount f-bold"></span></div> <div class="bns-notification__timer"> <span class="bns-timer f-bold"></span> <div class="bns-notification__tooltip">'+t.t("bns.offerExpires")+' <b class="tooltip-timer"></b> </div> </div></div>'}},99:function(t,e,i){}}]);